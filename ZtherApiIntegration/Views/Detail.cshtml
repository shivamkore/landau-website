@using ZtherApiIntegration.Models.Detail
@using ZtherApiIntegration.Common

@model DetailModel

<div>

    <div id="detail_page">
        <div class="modal_overlay"></div>
        <div class="detail_modal">
            <div style="display:none" id="divCurrentProductCode">@Model.ProductDetail.Code</div>
            <div class="mobile_exit">
                <img src="public/images/detail/icons/x_close_white.png">

            </div>
            <img class="exit" src="public/images/detail/icons/x_close.png">

            <!-- Size Chart Partial -->
            @Html.Partial("~/Views/Partials/Detail/_SizeChartPartial.cshtml", Model)

        </div>

        <div class="detail_top">

            <!-- Detail Left Partial  -->
            @Html.Partial("~/Views/Partials/Detail/_DetailLeftPartial.cshtml")

            <!-- Detail Right Partial  -->
            @Html.Partial("~/Views/Partials/Detail/_DetailRightPartial.cshtml", Model)

        </div>

        <!-- Power Reviews Detail Review & Question Display -->
        <div id="pr-reviewdisplay"></div>
        <div id="pr-questiondisplay"></div>

    </div>

</div>

<!-- Modal Dialog Box Start -->
@{
    var url = System.Configuration.ConfigurationManager.AppSettings["Widget-Endpoint"];

    if (Model.SelectedColor != null && Model.SelectedColor.SwatchType != null && Model.SelectedColor.SwatchType.Equals("Print", StringComparison.InvariantCultureIgnoreCase))
    {
        url = string.Concat(url, Model.ProductDetail.Code, Model.SelectedColor.ColorCode);
    }
    else
    {
        url = string.Concat(url, Model.ProductDetail.Code);
    }
}

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">BUY NOW</h4>
            </div>
            <div class="modal-body">
                <div id="widget-container">
                    <iframe id="where-to-buy-dialog" src="@url" frameborder="0" scrolling="auto" allowtransparency="true"></iframe>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal Dialog Box End -->

<script src="public/js/logic/detail.js"></script>

@* Power Reviews JS script. *@
<script src="//ui.powerreviews.com/stable/4.0/ui.js"></script>

<script type="text/javascript">
    setValues('@Model.ProductDetail.Code', '@Model.ProductDetail.DefaultColorCode', '@(Model.ColorsAndSizes.ProductCategorySizes.Count > 0 ? Model.ColorsAndSizes.ProductCategorySizes[0] : "")');
</script>

<script>

    fbq('track', 'ViewContent');

    // Power Reviews script for rendering review review snippet, review display and question display.
    POWERREVIEWS.display.render({
        api_key: '@Model.PowerReview.API_Key',
        locale: '@Model.PowerReview.Locale',
        merchant_group_id: '@Model.PowerReview.Merchant_Group_Id',
        merchant_id: '@Model.PowerReview.Merchant_Id',
        page_id: '@Model.PowerReview.ProductCode',
        review_wrapper_url: '@Model.PowerReview.Write_Review_URL',
        style_sheet: '@Model.PowerReview.StyleSheet',
        components: {
            ReviewSnippet: 'pr-reviewsnippet',
            ReviewDisplay: 'pr-reviewdisplay',
            QuestionDisplay: 'pr-questiondisplay'
        }
    });

</script>
